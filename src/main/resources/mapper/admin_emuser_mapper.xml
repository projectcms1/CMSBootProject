<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cms.ca.admin.emuser_repo">
<select id="employee_list" resultType="com.cms.ca.employee_dto" >
select * from EMP_INFO where MNG_AUTHRT = 'P' or MNG_AUTHRT = 'C' order by EMP_NO desc
</select>
<select id="employee_data" resultType="com.cms.ca.employee_dto" parameterType="String">
select a.*, b.ACNT_LCK_YN, b.REG_DT from EMP_INFO as a JOIN LGN_ACNT_INFO as b where a.USER_NO = b.USER_NO and a.EMP_NO = #{emp_no}
</select>

<!-- 교직원 사용자 추가 시작 -->
<insert id="add_emuser_login" parameterType="com.cms.ca.login_dto" >
insert into LGN_ACNT_INFO (USER_NO, LGN_ID, PSWD,LAST_LGN_DT, ACNT_LCK_YN, REG_DT)
values ('0', #{lgn_id}, #{pswd}, now(), 'N', now())
</insert>

<select id="match_em_userno" parameterType="com.cms.ca.login_dto" resultType="Integer">
select USER_NO from LGN_ACNT_INFO where LGN_ID=#{lgn_id}
</select>

<insert id="add_emuser_detail" parameterType="com.cms.ca.employee_dto">
insert into EMP_INFO
(emp_no, emp_flnm, user_no, emp_eml_addr, emp_telno, emp_zip, emp_addr, emp_daddr, emp_photo, brdt, dlng_bank_nm, dlng_actno, dpstr_nm, 
ogdp_inst_nm, ogdp_dept_nm, jbgd_nm, mjr, acnt_stts, mng_authrt)
values (#{emp_no}, #{emp_flnm}, #{user_no}, #{emp_eml_addr}, #{emp_telno},
#{emp_zip}, #{emp_addr}, #{emp_daddr}, #{emp_photo}, #{brdt},
#{dlng_bank_nm}, #{dlng_actno}, #{dpstr_nm},
#{ogdp_inst_nm}, #{ogdp_dept_nm}, #{jbgd_nm}, #{mjr}, "Y", #{mng_authrt})
</insert>

<!-- 교직원 사용자 추가 끝 -->
</mapper>